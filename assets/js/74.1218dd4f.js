(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{382:function(t,s,a){"use strict";a.r(s);var e=a(25),r=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"wsl2-说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#wsl2-说明"}},[t._v("#")]),t._v(" WSL2 说明")]),t._v(" "),s("h2",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[t._v("#")]),t._v(" 安装")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows/wsl/",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方文档"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"常用配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常用配置"}},[t._v("#")]),t._v(" 常用配置")]),t._v(" "),s("blockquote",[s("p",[t._v("安装windows子系统, 设置默认root登录")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cmd 进入Apps目录,列出目录,找到ubuntu子系统目录(CanonicalGroupLimited开头的目录)")]),t._v("\n$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" %HOMEPATH%"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("AppData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Local"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Microsoft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("WindowsApps\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dir")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 进入子系统目录, 设置默认root登录")]),t._v("\n$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" CanonicalGroupLimited.Ubuntu20.04onWindows_79rhkp1fndgsc\n$ ubuntu2004.exe config --default-user root\n")])])]),s("blockquote",[s("p",[t._v("存储文件移出系统盘, PowerShell执行如下命令")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 关闭wsl")]),t._v("\n$ wsl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--shutdown")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看是否已经关闭, 看(STATE) 列")]),t._v("\n$ wsl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-l")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v("\n  NAME                   STATE           VERSION\n* Ubuntu-20.04           Stopped         "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n  docker-desktop-data    Stopped         "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n  docker-desktop         Stopped         "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n  \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 导出子系统文件, wsl --export [子系统名称] [导出子系统tar包]")]),t._v("\n$ wsl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--export")]),t._v(" Ubuntu-20.04 D:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Ubuntu-20.04.tar\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注销原子系统")]),t._v("\n$ wsl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--unregister")]),t._v(" Ubuntu-20.04\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 导入子系统, wsl --import [子系统名称] [导入的子系统位置] [导入子系统tar包(上面导出的tar包)]")]),t._v("\n$ wsl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--import")]),t._v(" Ubuntu-20.04 D:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("software"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("wsl2 D:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Ubuntu-20.04.tar\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置默认账号")]),t._v("\n$ ubuntu2004 config --default-user root\n")])])]),s("blockquote",[s("p",[t._v("Docker Desktop 移出系统盘")])]),t._v(" "),s("p",[t._v("默认情况下，Docker Desktop for Window会创建如下两个发行版（distro）：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("docker-desktop")]),t._v("：用于存放程序;")]),t._v(" "),s("li",[s("code",[t._v("docker-desktop-data")]),t._v("：用于存放镜像;")])]),t._v(" "),s("p",[t._v("访问"),s("code",[t._v("%LOCALAPPDATA%/Docker/wsl")]),t._v("目录，就可以看到两个文件夹：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("data/ext4.vhdx")]),t._v("被 "),s("code",[t._v("docker-desktop-data")]),t._v(" 发行版使用;")]),t._v(" "),s("li",[s("code",[t._v("distro/ext4.vhdx")]),t._v("被 "),s("code",[t._v("docker-desktop")]),t._v(" 发行版使用;")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 删除所有容器和镜像")]),t._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" stop "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-q")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-aq")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" rmi "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" images "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-qa")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 关闭所有发行版")]),t._v("\n$ wsl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--shutdown")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 检查所有发行版是否已关闭")]),t._v("\n$ wsl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-l")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v("\n  NAME                   STATE           VERSION\n* Ubuntu-20.04           Stopped         "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n  docker-desktop-data    Stopped         "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n  docker-desktop         Stopped         "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n  \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 导出所有发行版")]),t._v("\n$ wsl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--export")]),t._v(" docker-desktop D:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("docker-desktop.tar\n$ wsl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--export")]),t._v(" docker-desktop-data D:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("docker-desktop-data.tar\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注销所有发行版")]),t._v("\n$ wsl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--unregister")]),t._v(" docker-desktop\n$ wsl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--unregister")]),t._v(" docker-desktop-data\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 导入所有发行版")]),t._v("\n$ wsl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--import")]),t._v(" docker-desktop D:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("software"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("wsl2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("docker"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("distro D:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("docker-desktop.tar "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--version")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n$ wsl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--import")]),t._v(" docker-desktop-data D:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("software"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("wsl2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("docker"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("data D:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("docker-desktop-data.tar "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--version")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n")])])]),s("blockquote",[s("p",[t._v("WSL无法启动")])]),t._v(" "),s("p",[t._v("可是使用管理员模式运行Power Shell或CMD并输入: "),s("code",[t._v("netsh winsock reset")]),t._v(" 执行后重启电脑解决。")]),t._v(" "),s("h2",{attrs:{id:"局域网配置访问"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#局域网配置访问"}},[t._v("#")]),t._v(" 局域网配置访问")]),t._v(" "),s("blockquote",[s("p",[t._v("设置端口转发")])]),t._v(" "),s("p",[s("code",[t._v("connect*：")]),t._v("wsl参数，"),s("code",[t._v("listen*：")]),t._v("宿主机参数")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Ubuntu 终端")]),t._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ip")]),t._v(" addr show eth0\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(": eth0: "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("BROADCAST,MULTICAST,UP,LOWER_UP"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" mtu "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1500")]),t._v(" qdisc mq state UP group default qlen "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v("\n    link/ether 00:15:5d:cd:45:4a brd ff:ff:ff:ff:ff:ff\n    inet "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.17")]),t._v(".163.214/28 brd "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.17")]),t._v(".163.223 scope global eth0\n       valid_lft forever preferred_lft forever\n    inet6 fe80::215:5dff:fecd:454a/64 scope "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("link")]),t._v("\n       valid_lft forever preferred_lft forever\n       \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Powershell ")]),t._v("\n$ netsh interface portproxy "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" v4tov4 "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("listenport")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10081")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("listenaddress")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("* "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("connectport")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10081")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("connectaddress")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.17")]),t._v(".163.214 "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("protocol")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("tcp\n\n$ netsh interface portproxy show all\n\n侦听 ipv4:                 连接到 ipv4:\n\n地址            端口        地址            端口\n--------------- ----------  --------------- ----------\n*               "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10081")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.17")]),t._v(".17.232   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10081")]),t._v("\n")])])]),s("blockquote",[s("p",[t._v("删除端口转发")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Powershell ")]),t._v("\n$ netsh interface portproxy delete v4tov4 "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("listenport")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10081")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("listenaddress")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("*\n")])])]),s("blockquote",[s("p",[t._v("配置入站规则")])]),t._v(" "),s("p",[t._v("设置–>搜索《防火墙和网络保护》–>高级设置—>入站规则–>新建规则–>端口–>TCP,特定本地端口–>允许连接")])])}),[],!1,null,null,null);s.default=r.exports}}]);